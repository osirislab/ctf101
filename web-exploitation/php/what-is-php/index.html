<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Capture The Flag Competition Wiki"> 
    <meta name="author" content="OSIRIS Lab & CTFd LLC"> 
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    <title>What is PHP? - CTF 101</title>

    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">


    <link href="../../../admonition.css" rel="stylesheet">


    <link href="../../../extra.css" rel="stylesheet">


    <link href="../../../colorful.css" rel="stylesheet">


    <link href="../../../zoom.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Gudea:400,400i,700" rel="stylesheet">
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../../..">
                <img class="no-zoom" width="100px" src="/images/ctf101.png" title="CTF 101">
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                
                    
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Forensics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../forensics/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">File Formats</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-are-file-formats/">What are File Formats</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Metadata</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-metadata/">What is Metadata</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Wireshark</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-wireshark/">What is Wireshark</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Stegonagraphy</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-stegonagraphy/">What is Stegonagraphy</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Disk Imaging</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-disk-imaging/">What is Disk Imaging</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Memory Forensics</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-memory-forensics/">What is Memory Forensics</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Hex Editors</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../forensics/what-is-a-hex-editor/">What is a Hex Editor</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cryptography <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cryptography/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">XOR</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-is-xor/">What is XOR</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Substitution Cipher</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-is-a-substitution-cipher/">What is a Substitution Cipher</a>
</li>

        
            
<li >
    <a href="../../../cryptography/what-is-caesar-cipher-rot-13/">Caesar Cipher/ROT 13</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Vigenere Cipher</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-is-a-vigenere-cipher/">What is a Vigenere Cipher</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Hashing Functions</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-are-hashing-functions/">What are Hashing Functions</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Modes of Operation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-are-block-ciphers/">What are Block Ciphers</a>
</li>

        
            
<li >
    <a href="../../../cryptography/what-are-stream-ciphers/">What are Stream Ciphers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">RSA</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../cryptography/what-is-rsa/">What is RSA</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Web Exploitation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">SQL Injection</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../sql-injection/what-is-sql-injection/">What is SQL Injection</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Command Injection</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../command-injection/what-is-command-injection/">What is Command Injection</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Directory Traversal</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../directory-traversal/what-is-directory-traversal/">What is Directory Traversal</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Cross Site Request Forgery</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cross-site-request-forgery/what-is-cross-site-request-forgery/">What is Cross Site Request Forgery</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Cross Site Scripting (XSS)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cross-site-scripting/what-is-cross-site-scripting/">What is Cross Site Scripting</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Server Side Request Forgery</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../server-side-request-forgery/what-is-server-side-request-forgery/">What is Server Side Request Forgery</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">PHP</a>
    <ul class="dropdown-menu">
        
            
<li class="active">
    <a href="./">What is PHP?</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reverse Engineering <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../reverse-engineering/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Assembly/Machine Code</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reverse-engineering/what-is-assembly-machine-code/">What is Assembly/Machine Code</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The C Programming Language</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reverse-engineering/what-is-c/">What is C</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Disassemblers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reverse-engineering/what-are-disassemblers/">What are Disassemblers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Debuggers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reverse-engineering/what-is-gdb/">What is GDB</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Decompilers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reverse-engineering/what-are-decompilers/">What are Decompilers</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Binary Exploitation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../binary-exploitation/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Registers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-are-registers/">What are Registers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The Stack</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-is-the-stack/">What is the Stack</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Calling Conventions</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-are-calling-conventions/">What are Calling Conventions</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Global Offset Table (GOT)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-is-the-got/">What is the GOT</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Buffers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-are-buffers/">What are Buffers</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/buffer-overflow/">Buffer Overflow</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Return Oriented Programming (ROP)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/return-oriented-programming/">What is ROP</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Binary Security</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-is-binary-security/">What is Binary Security</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/no-execute/">No eXecute (NX)</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/address-space-layout-randomization/">Address Space Layout Randomization (ASLR)</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/stack-canaries/">Stack Canaries</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/relocation-read-only/">Relocation Read-Only (RELRO)</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The Heap</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-is-the-heap/">What is the Heap</a>
</li>

        
            
<li >
    <a href="../../../binary-exploitation/heap-exploitation/">Heap Exploitation</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Format String Vulnerability</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../binary-exploitation/what-is-a-format-string-vulnerability/">What is a Format String Vulnerability</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i>
                        </a>
                    </li>
<!--                     <li >
                        <a rel="next" href="../../server-side-request-forgery/what-is-server-side-request-forgery/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../../reverse-engineering/overview/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li> -->
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#php">PHP</a></li>
            <li class="second-level"><a href="#overview">Overview</a></li>
                
            <li class="second-level"><a href="#example">Example</a></li>
                
            <li class="second-level"><a href="#type-juggling">Type Juggling</a></li>
                
                <li class="third-level"><a href="#type-comparison-table">Type Comparison Table</a></li>
            <li class="second-level"><a href="#file-inclusion">File Inclusion</a></li>
                
            <li class="second-level"><a href="#php-stream-filters">PHP Stream Filters</a></li>
                
                <li class="third-level"><a href="#example_1">Example</a></li>
                <li class="third-level"><a href="#exploitation">Exploitation</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="php">PHP<a class="headerlink" href="#php" title="Permanent link">&para;</a></h1>
<p>PHP is one of the most used languages for back-end web development and therefore it has become a target by hackers. PHP is a language which makes it painful to be secure for most instances, making it every hacker's dream target.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>PHP is a C-like language which uses tags enclosed by <code class="codehilite"><span class="cp">&lt;?php</span> <span class="o">...</span> <span class="cp">?&gt;</span></code> (sometimes just <code class="codehilite"><span class="cp">&lt;?</span> <span class="o">...</span> <span class="cp">?&gt;</span></code>). It is inlined into HTML. A word of advice is to keep the php docs open because function names are strange due to the fact that the length of function name is used to be the key in PHP's internal dictionary, so function names were shortened/lengthened to make the lookup faster. Other things include:</p>
<ul>
<li>Variables start with $: <code class="codehilite">$name</code></li>
<li>Variable variables: <code class="codehilite">$$name</code></li>
<li>Request-specific dictionaries: <code class="codehilite">$_GET, $_POST, $_SERVER</code></li>
</ul>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_METHOD&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;POST&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;cs3284&#39;</span><span class="p">,</span> <span class="s1">&#39;cs3284&#39;</span><span class="p">,</span> <span class="s1">&#39;logmein&#39;</span><span class="p">);</span>
        <span class="nv">$email</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span>
        <span class="nv">$password</span> <span class="o">=</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]);</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE email = &#39;</span><span class="si">$email</span><span class="s2">&#39; AND password = &#39;</span><span class="si">$password</span><span class="s2">&#39;&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">())</span> <span class="p">{</span>
            <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
            <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Location: index.php&#39;</span><span class="p">);</span>
            <span class="k">die</span><span class="p">();</span>
        <span class="p">}</span>
   <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;html&gt;...</span>
</pre></div>


<p>This example PHP simply checks the POST data for an email and password. If the password is equal to the hashed password in the database, the use is logged in and redirected to the index page.</p>
<p>The line <code class="codehilite">email = &#39;$email&#39;</code> uses automatic string interpolation in order to convert $email into a string to compare with the database.</p>
<h2 id="type-juggling">Type Juggling<a class="headerlink" href="#type-juggling" title="Permanent link">&para;</a></h2>
<p>PHP will do just about anything to match with a loose comparison (==) which means things can be 'equal' (==) or <em>really</em> equal (===). The implicit integer parsing to strings is the root cause of a lot of issues in PHP.</p>
<h3 id="type-comparison-table">Type Comparison Table<a class="headerlink" href="#type-comparison-table" title="Permanent link">&para;</a></h3>
<h4 id="comparisons-of-x-with-php-functions">Comparisons of $x with PHP Functions<a class="headerlink" href="#comparisons-of-x-with-php-functions" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Expression</th>
<th>gettype()</th>
<th>empty()</th>
<th>is_null()</th>
<th>isset()</th>
<th>boolean: <code class="codehilite">if($x)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>$x = "";</td>
<td>string</td>
<td>TRUE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = null;</td>
<td>NULL</td>
<td>TRUE</td>
<td>TRUE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>var $x;</td>
<td>NULL</td>
<td>TRUE</td>
<td>TRUE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x is undefined</td>
<td>NULL</td>
<td>TRUE</td>
<td>TRUE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = array();</td>
<td>array</td>
<td>TRUE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = array('a', 'b');</td>
<td>array</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = false;</td>
<td>boolean</td>
<td>TRUE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = true;</td>
<td>boolean</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = 1;</td>
<td>integer</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = 42;</td>
<td>integer</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = 0;</td>
<td>integer</td>
<td>TRUE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = -1;</td>
<td>integer</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = "1";</td>
<td>string</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = "0";</td>
<td>string</td>
<td>TRUE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>FALSE</td>
</tr>
<tr>
<td>$x = "-1";</td>
<td>string</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = "php";</td>
<td>string</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = "true";</td>
<td>string</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
<tr>
<td>$x = "false";</td>
<td>string</td>
<td>FALSE</td>
<td>FALSE</td>
<td>TRUE</td>
<td>TRUE</td>
</tr>
</tbody>
</table>
<h4 id="comparisons">"==" Comparisons<a class="headerlink" href="#comparisons" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th></th>
<th>TRUE</th>
<th>FALSE</th>
<th>1</th>
<th>0</th>
<th>-1</th>
<th>"1"</th>
<th>"0"</th>
<th>"-1"</th>
<th>NULL</th>
<th>array()</th>
<th>"php"</th>
<th>""</th>
</tr>
</thead>
<tbody>
<tr>
<td>TRUE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
</tr>
<tr>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
</tr>
<tr>
<td>1</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>0</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td><mark>TRUE</mark></td>
</tr>
<tr>
<td>-1</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"1"</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"0"</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"-1"</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>NULL</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
</tr>
<tr>
<td>array()</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"php"</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
</tr>
<tr>
<td>""</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
</tr>
</tbody>
</table>
<h4 id="comparisons_1">"===" Comparisons<a class="headerlink" href="#comparisons_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th></th>
<th>TRUE</th>
<th>FALSE</th>
<th>1</th>
<th>0</th>
<th>-1</th>
<th>"1"</th>
<th>"0"</th>
<th>"-1"</th>
<th>NULL</th>
<th>array()</th>
<th>"php"</th>
<th>""</th>
</tr>
</thead>
<tbody>
<tr>
<td>TRUE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>1</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>0</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>-1</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"1"</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"0"</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"-1"</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>NULL</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>array()</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
<td>FALSE</td>
</tr>
<tr>
<td>"php"</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
<td>FALSE</td>
</tr>
<tr>
<td>""</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td>FALSE</td>
<td><mark>TRUE</mark></td>
</tr>
</tbody>
</table>
<h2 id="file-inclusion">File Inclusion<a class="headerlink" href="#file-inclusion" title="Permanent link">&para;</a></h2>
<p>PHP has multiple ways to include other source files such as require, require_once and include. These can take a dynamic string such as <code class="codehilite">require $_GET[&#39;page&#39;] . &quot;.php&quot;;</code> which is usually seen in templating.</p>
<h2 id="php-stream-filters">PHP Stream Filters<a class="headerlink" href="#php-stream-filters" title="Permanent link">&para;</a></h2>
<p>PHP has its own URL scheme: <code class="codehilite">php://...</code> and  its main purpose is to filter output automatically. It can automatically remove certain HTML tags and can base64 encode as well.</p>
<h3 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="x">$fp = fopen(&#39;php://output&#39;, &#39;w&#39;);</span>
<span class="x">stream_filter_append(</span>
<span class="x">       $fp,</span>
<span class="x">       &#39;string.strip_tags&#39;,</span>
<span class="x">       STREAM_FILTER_WRITE,</span>
<span class="x">       array(&#39;b&#39;,&#39;i&#39;,&#39;u&#39;));</span>
<span class="x">fwrite($fp, &quot;&lt;b&gt;bolded text&lt;/b&gt; enlarged to a &lt;h1&gt;level 1 heading&lt;/h1&gt;\n&quot;);</span>
<span class="x">/* &lt;b&gt;bolded text&lt;/b&gt; enlarged to a level 1 heading */</span>
</pre></div>


<h3 id="exploitation">Exploitation<a class="headerlink" href="#exploitation" title="Permanent link">&para;</a></h3>
<p>These filters can also be used on input such as:</p>
<ul>
<li><code class="codehilite">php://filter/convert.base64-encode/resource={file}</code></li>
<li><code class="codehilite">include</code>, <code class="codehilite">file_get_contents()</code>, etc. support URLs including PHP stream filter URLs (<code class="codehilite">php://</code>)</li>
<li><code class="codehilite">include</code> normally evaluates any PHP code (in tags) it finds, but if itâ€™s base64 encoded it can be used to leak source</li>
</ul></div>
            
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>A project by the <a href="https://osiris.cyber.nyu.edu">OSIRIS Lab</a> and <a href="https://ctfd.io/">CTFd LLC</a></small>
    </footer>

    <script src="../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../../..';
    </script>
    <script data-main="../../../mkdocs/js/search.js" src="../../../search/require.js"></script>
    <script src="../../../js/base.js"></script>
    <script src="../../../extra.js"></script>
    <script src="../../../zoom-vanilla.min.js"></script>
    <script src="../../../search/require.js"></script>
    <script src="../../../search/search.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
